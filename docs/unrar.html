<!DOCTYPE html>
<html>
<head>
	<title>Documentation of the RAR format</title>
	<style type="text/css">
	body {
		font-size: 12pt;
		font-family: monospace; 
	}
	pre {
		margin-left: 2em;
	}
	table, th, td {
		border-width: 1px;
		border-style: solid;
		border-color: grey;
	}
	table {
		margin-left: 2em;
		padding: 2px;
	}
	th, td {
		padding-left: 5px;
		padding-right: 5px;
	}
	th {
		background-color: lightgrey;
	}
	</style>
</head>
<body>
<h1>The RAR Format</h1>

<h2 id="intro"><a href="#intro">1 Introduction</a></h2>

<p>This document will describe the RAR format, since it is currently an undocumented format. It seeks to serve a similar role as the <a href="http://www.pkware.com/documents/casestudies/APPNOTE.TXT">ZIP App Note</a>. This document is very much a work-in-progress and is far from complete.  If you wish to help, please <a href="#credits">contact Jeff Schiller</a>.</p>

<p><strong>NOTE 1:</strong> This documentation <strong><em>MUST NOT</em></strong> be used to create RAR-compatible archive programs like <a href="http://www.rarlab.com/">WinRAR</a>. This documentation is only for the purposes of writing decompression software (i.e. unrar) in various languages and was reverse-engineered from the UnRAR source located at <a href="http://www.rarlab.com/rar_add.htm">this page</a> with <a href="#credits">Eugene Roshal's</a> permission.</p>

<p><strong>NOTE 2:</strong> This documentation will initially focus on what I believe is Version 3 of the RAR format.</p>

<h2 id="format"><a href="#format">2 General Format of a .RAR File</a></h2>

<p>Overall .RAR file format:</p>

<pre>
signature               7 bytes    (0x52 0x61 0x72 0x21 0x1A 0x07 0x00)
[1st <a href="#volume-header-format">volume header</a>]
...
[2nd volume header]
...
...
[nth volume header]
...
</pre>

<h3 id="volume-header-format"><a href="#volume-header-format">2.1 Volume Header Format</a></h3>

<pre>
header_crc              2 bytes
<a href="#volume-header-type">header_type</a>             1 byte
<a href="#volume-header-flags">header_flags</a>            2 bytes
header_size             2 bytes
unused_bytes            (header_size - 7) bytes
</pre>

<h4 id="volume-header-type"><a href="#volume-header-type">2.1.1 Header Type</a></h4>

<p>The header type is 8 bits (1 byte) and can have the following values:</p>

<table>
	<tr><th>Value</th><th>Type</th></tr>
	<tr><td>0x72</td><td>MARK_HEAD</td></tr>
	<tr><td>0x73</td><td>MAIN_HEAD</td></tr>
	<tr><td>0x74</td><td>FILE_HEAD</td></tr>
	<tr><td>0x75</td><td>COMM_HEAD</td></tr>
	<tr><td>0x76</td><td>AV_HEAD</td></tr>
	<tr><td>0x77</td><td>SUB_HEAD</td></tr>
	<tr><td>0x78</td><td>PROTECT_HEAD</td></tr>
	<tr><td>0x79</td><td>SIGN_HEAD</td></tr>
	<tr><td>0x7a</td><td>NEWSUB_HEAD</td></tr>
	<tr><td>0x7b</td><td>ENDARC_HEAD</td></tr>
</table>

<h4 id="volume-header-flags"><a href="#volume-header-flags">2.1.2 Header Flags</a></h4>

<p>The header flags are 16 bits (2 bytes).  The flags are:</p>

<table>
	<tr><th>Value</th><th>Flag</th></tr>
	<tr><td>0x0001</td><td>MHD_VOLUME</td></tr>
	<tr><td>0x0002</td><td>MHD_COMMENT</td></tr>
	<tr><td>0x0004</td><td>MHD_LOCK</td></tr>
	<tr><td>0x0008</td><td>MHD_SOLID</td></tr>
	<tr><td>0x0010</td><td>MHD_PACK_COMMENT or MHD_NEWNUMBERING</td></tr>
	<tr><td>0x0020</td><td>MHD_AV</td></tr>
	<tr><td>0x0040</td><td>MHD_PROTECT</td></tr>
	<tr><td>0x0080</td><td>MHD_PASSWORD</td></tr>
	<tr><td>0x0100</td><td>MHD_FIRSTVOLUME</td></tr>
	<tr><td>0x0200</td><td>MHD_ENCRYPTVER</td></tr>
</table>


<h2 id="credits"><a href="#credits">3 Credits</a></h2>

<ul>
<li>Eugene Roshal &lt;roshal@rarlab.com&gt; - creator and owner of the RAR format</li>
<li>Jeff Schiller &lt;codedread@gmail.com&gt; - creator of this document as part of the <a href="http://kthoom.googlecode.com/">kthoom</a> project</li>
</ul>

</body>
</html>